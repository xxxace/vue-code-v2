{"version":3,"file":"bundle.js","sources":["../src/shared/utils.js","../src/reactive/index.js","../src/constant/index.js","../src/obeserver/array.js","../src/obeserver/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["const toString = Object.prototype.toString;\r\n\r\nfunction getType(val) {\r\n    return toString.call(val).slice(8, -1).toLowerCase();\r\n}\r\n\r\nexport function isArray(val) {\r\n    return getType(val) === 'array';\r\n}","import { observe } from \"../obeserver\";\r\n\r\nexport function defineReactiveData(data, key, value) {\r\n    observe(value);\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            console.log('get', key)\r\n            return value;\r\n        },\r\n        set(newValue) {\r\n            console.log('set', key)\r\n            if (newValue === value) return;\r\n            observe(newValue);\r\n            value = newValue;\r\n        }\r\n    })\r\n}","const ARR_METHODS = [\r\n    'push',\r\n    'pop',\r\n    'unshift',\r\n    'shift',\r\n    'splice',\r\n    'sort',\r\n    'reverse'\r\n]\r\n\r\nexport {\r\n    ARR_METHODS\r\n}","import { observe } from \"./index\";\r\nimport {ARR_METHODS} from '../constant';\r\n\r\nfunction observeArr(arr) {\r\n    for (let i = 0; i < arr.length; i++) {\r\n        observe(arr[i]);\r\n    }\r\n}\r\n\r\nconst originArrMethods = Array.prototype,\r\n    arrMethods = Object.create(originArrMethods);\r\n\r\nARR_METHODS.map((key) => {\r\n    arrMethods[key] = function () {\r\n        const args = Array.prototype.slice.call(arguments),\r\n            res = originArrMethods[key].apply(this, args);\r\n\r\n        console.log('new ' + key, args)\r\n        let newArr;\r\n\r\n        switch (key) {\r\n            case 'push':\r\n            case 'unshift':\r\n                newArr = args;\r\n                break\r\n            case 'splice':\r\n                newArr = args.slice(2);\r\n                break\r\n            default:\r\n                break\r\n        }\r\n\r\n        newArr && observeArr(newArr);\r\n\r\n        return res;\r\n    }\r\n});\r\n\r\nexport {\r\n    arrMethods\r\n}\r\n\r\nexport default observeArr;","import { isArray } from \"../shared/utils\";\r\nimport { defineReactiveData } from '../reactive';\r\nimport observeArr,{ arrMethods } from \"./array.js\";\r\n\r\nfunction Observer(target) {\r\n    if (isArray(target)) {\r\n        target.__proto__ = arrMethods;\r\n        observeArr(target);\r\n    } else {\r\n        this.walk(target);\r\n    }\r\n}\r\n\r\nObserver.prototype.walk = function (target) {\r\n    const keys = Object.keys(target);\r\n\r\n    for (let i = 0; i < keys.length; i++) {\r\n        let key = keys[i],\r\n            value = target[key];\r\n\r\n        defineReactiveData(target, key, value);\r\n    }\r\n}\r\n\r\nexport function observe(target) {\r\n    if (typeof target !== 'object' || target === null) return;\r\n\r\n    return new Observer(target);\r\n}\r\n\r\nexport default Observer;","export function proxyData(vm, target, key) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[target][key];\r\n        },\r\n        set(newValue) {\r\n            vm[target][key] = newValue;\r\n        }\r\n    })\r\n}","import { observe } from \"./obeserver\";\r\nimport { proxyData } from \"./state.js\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = init;\r\n}\r\n\r\nfunction init(options) {\r\n    const vm = this;\r\n    vm.$options = options;\r\n\r\n    initState(vm);\r\n}\r\n\r\nexport function initState(vm) {\r\n    const options = vm.$options;\r\n\r\n    if (options.data) {\r\n        initData(vm);\r\n    }\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    vm.$data = data = typeof data === 'function' ? data.call(vm) : data || {};\r\n\r\n    for (let key in data) {\r\n        proxyData(vm, '$data', key);\r\n    }\r\n\r\n    observe(data);\r\n}","import { initMixin } from './init.js';\r\nconsole.log('hello rollup')\r\nfunction Vue(options) {\r\n    this._init(options);\r\n}\r\n\r\ninitMixin(Vue);\r\n\r\nexport default Vue;\r\n\r\n"],"names":["toString","Object","prototype","getType","val","call","slice","toLowerCase","isArray","defineReactiveData","data","key","value","observe","defineProperty","get","console","log","set","newValue","ARR_METHODS","observeArr","arr","i","length","originArrMethods","Array","arrMethods","create","map","args","arguments","res","apply","newArr","Observer","target","__proto__","walk","keys","_typeof","proxyData","vm","initMixin","Vue","_init","init","options","$options","initState","initData","$data"],"mappings":"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"}